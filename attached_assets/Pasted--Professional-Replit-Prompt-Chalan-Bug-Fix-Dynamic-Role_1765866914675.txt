âœ… Professional Replit Prompt â€“ Chalan Bug Fix + Dynamic Role & User Rights
ğŸ”¹ Project Context

I already have an existing production-style software project with completed UI, modules, and workflows.

Your task is to fix specific bugs and improve role & permission management, while following these rules:

âŒ Do NOT redesign UI

âŒ Do NOT change existing workflows

âŒ Do NOT hard-code permissions for any role

âœ… Fix backend & frontend logic only

âœ… Permissions must be fully dynamic

âœ… MySQL must be used strictly

ğŸ” Database Rules (Strict)

Use MySQL only

Use existing MySQL setup (mysql2 / ORM already in project).

No SQLite / Mongo / Prisma DB switch.

Replit Environment

Inside Replit:

Auto-create database & tables only for testing.

Use .env variables:

DB_HOST
DB_USER
DB_PASSWORD
DB_NAME


Keep DB config centralized so I can easily replace credentials after downloading.

Do NOT break existing tables

Only add tables/columns if required for permissions.

No destructive schema changes.

ğŸ BUG FIX â€“ Chalan Creation Error
1ï¸âƒ£ Chalan Entry Error (â€œlike is not definedâ€)

Problem (from uploaded image):

When creating Chalan from Booking, system throws:

Error creating chalan: "like is not defined"


Chalan is not created.

Fix Required:

Identify backend query using LIKE incorrectly or without import/ORM operator.

Fix query safely:

If Sequelize â†’ use Op.like

If raw SQL â†’ use proper LIKE ? syntax

Ensure:

Chalan Date is correctly parsed (YYYY-MM-DD)

Items, quantity, rate, notes save correctly

Do NOT change Chalan UI or flow.

ğŸ‘¥ Dynamic Role & Permission System (CORE REQUIREMENT)
2ï¸âƒ£ Add New Role: custom
User Management

Add custom role option along with:

admin

gst

nongst

When creating a user with role = custom:

User should be created with NO access by default

No module should be visible initially

3ï¸âƒ£ User Rights â€“ Fully Dynamic Access Control
Current Problems

Checkboxes are not reflecting saved permissions

gst / nongst permissions are hard-coded

Admin cannot fully control access dynamically

âœ… Required Behavior (Very Important)
A. Permission Source

ALL permissions must come from User Rights table

NO role (admin / gst / nongst / custom) should have fixed permissions in code

B. User Rights Screen

When admin opens User Rights Management:

Select a user or role

System should:

Fetch permissions from DB

Auto-check corresponding checkboxes

Admin can:

Grant / remove permissions dynamically

Save changes

C. Permission Granularity

Permissions must support:

Module level (Booking, Chalan, Reports, Masters, etc.)

Action level:

View

Create

Edit

Delete

Example Scenarios (Must Work):

Custom user:

âœ… View Booking

âŒ Create / Edit / Delete Booking

GST user:

âŒ Edit Chalan

âœ… View Booking Report

Non-GST user:

âœ… View Reports only

D. Enforcement (Frontend + Backend)

Frontend

Hide buttons user has no access to

Disable routes if view permission is missing

Backend (Mandatory)

Validate permissions before every API action

Even if user bypasses UI â†’ API must block unauthorized access

ğŸ§© Suggested Permission Structure (If Needed)

You may add a table like:

permissions
- id
- role OR user_id
- module
- can_view
- can_create
- can_edit
- can_delete


But do NOT change existing logic unless necessary.

ğŸ¯ Final Expectations

âœ… Chalan creation works without error

âœ… Custom role works with zero access by default

âœ… Admin can dynamically control:

custom

gst

nongst

âœ… User Rights checkboxes reflect saved permissions

âœ… Permissions enforced in UI and backend

âœ… MySQL used strictly inside Replit

âš ï¸ IMPORTANT

Before finalizing:

Test Chalan creation

Test role change impact instantly

Test restricted API access via role permissions